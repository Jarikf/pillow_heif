[tool.cibuildwheel.linux]
before-all = [
    "yum install -y wget libtool git-all",
    "chmod +x ./scripts/init_linux.sh",
    "./scripts/init_linux.sh",
]

[tool.cibuildwheel.macos]
before-all = [
    "brew install libffi libheif",
    "HOMEBREW_PREFIX=$(brew --prefix)",
    "echo \"REPAIR_LIBRARY_PATH=$HOMEBREW_PREFIX/lib\"",
]

repair-wheel-command = [
    "echo $REPAIR_LIBRARY_PATH",
    "DYLD_LIBRARY_PATH=$REPAIR_LIBRARY_PATH delocate-listdeps {wheel}",
    "DYLD_LIBRARY_PATH=$REPAIR_LIBRARY_PATH delocate-wheel -v --require-archs {delocate_archs} -w {dest_dir} {wheel}"
]
